# Matroid Intersection

**사전 지식.** 아래 항목을 모두 깊이 이해하고 있을 필요는 없지만 친숙한 개념이 있다면 Matroid Intersection을 빠르게 잘 이해할 수 있다.

1. 집합론과 집합 연산의 기초
1. 그래프의 신장 트리(Spanning tree)
1. 이분 그래프의 매칭
1. 벡터 공간의 선형 독립
1. 벡터 집합의 랭크(Rank)와 기저(Basis)
1. 가우스 소거법
1. 크루스칼의 최소 신장 트리 알고리즘
1. 쿤의 이분 매칭 알고리즘
1. 이산 수학

## 매트로이드

매트로이드는 벡터 공간의 선형 독립 개념을 추상화하고 일반화한 구조이다.

형식적인 정의는 다음과 같다. 매트로이드는 순서쌍 $\left\langle X, I \right\rangle$으로 표현된다. $X$는 ground set이고 $I$는 $X$의 모든 독립 부분 집합으로 이루어진 집합이다. 다시 말해 매트로이드 $\left\langle X, I \right\rangle$는 $X$의 각 부분 집합이 *독립*인지 *종속*인지 ($I$에 포함되는지 또는 $I$에 포함되지 않는지) 분류를 정한다.

모든 매트로이드는 다음의 세 가지 성질을 만족한다.

1. 공집합은 독립이다.
1. 독립 집합의 부분 집합은 독립이다.
1. 독립 집합 $A$가 독립 집합 $B$보다 크기가 작다면, $A$가 독립임을 유지하면서 $A$에 추가할 수 있는 $B$의 원소가 적어도 하나 존재한다.

이것은 매트로이드의 *공리적 성질*이다. 매트로이드임을 증명하기 위해서는 일반적으로 위의 세 가지 성질을 증명해야 한다.

**기저.** 임의의 최대 크기의 독립 집합은 주어진 매트로이드의 기저이다. 다시 말해 독립을 유지하면서 기저에 추가될 수 있는 원소가 존재하지 않는다. 모든 기저의 크기는 동일하다 (그렇지 않다면 세 번째 공리적 성질에 의해 큰 기저에서 작은 기저로 무언가를 추가할 수 있다). 기저는 다른 기저의 부분 집합이 아니다. 임의의 독립 집합은 어떤 기저의 부분 집합이다 (세 번째 성질에 의해 어떤 기저에 도달할 때까지 집합의 크기를 증가시킬 수 있다), 따라서 매트로이드의 모든 기저를 아는 것은 매트로이드를 완전히 표현하기에 충분하다.

**회로.** 전체 집합을 제외한 모든 부분 집합이 독립인 종속 집합은 회로이다. 다시 말해, 회로는 어떤 원소를 제거해도 독립이 되는 종속 집합이다. 회로는 다른 회로의 부분 집합이 아니다 (그렇지 않다면 더 큰 회로에서 종속을 유지하면서 원소들을 제거할 수 있다). 각 종속 집합은 적어도 하나의 회로를 부분 집합으로 갖는다. 기저와 동일하게, 매트로이드의 모든 회로를 아는 것은 매트로이드를 완전히 표현하기에 충분하다.

회로에는 또 다른 중요한 성질이 있다. 두 회로의 합집합에서 임의로 하나의 원소를 제거해도 집합은 여전히 어떤 회로를 갖는다. 특정한 종류의 매트로이드는 더 엄격한 성질을 갖는다. 서로 다른 두 회로의 대칭차집합은 항상 하나의 회로를 갖는다. 두 집합의 대칭차집합은 둘 중 하나의 집합에만 포함되는 모든 원소의 집합이다 ($A \Delta B = (A \setminus B) \cup (B \setminus A)$). 예를 들어, 이 성질은 그래프의 사이클 공간과 관련되어 있다.

**랭크. 랭크 함수.** 매트로이드의 랭크는 해당 기저의 크기이다. 그러나 랭크 대신 기저의 크기라고 직접 부를 수 있다면 랭크에 대한 구체적인 정의가 왜 필요할까? 랭크는 실제로 유연하지 않다 (랭크 대신 기저의 크기로 언급할 수 있다). 랭크를 더 유연하게 만들기 위해서 랭크 함수 $r(S)$를 정의할 수 있다. 이 함수는 ground set의 어떤 부분 집합 $S$의 최대 독립 집합의 크기를 알려준다. 어떤 부분 집합의 랭크 함수 값은 매트로이드에서 해당 부분 집합의 랭크라고 부를 수 있다. 부분 집합의 이러한 정보는 여러 상황에서 매우 우용하다. 랭크 함수의 성질은 다음과 같다.

1. 부분 집합의 랭크는 해당 부분 집합의 크기보다 클 수 없다.
1. 독립 집합의 랭크는 해당 부분 집합의 크기이다.
1. 전체 ground set의 랭크는 매트로이드의 랭크와 같다. 공집합의 랭크는 $0$이다.
1. 집합 $S$의 임의의 부분 집합의 랭크는 $S$의 랭크보다 크지 않다.
1. 집합에 하나의 원소를 추가하는 것은 집합의 랭크를 $1$만큼 증가시키거나 바꾸지 않고 유지한다. (어떤 집합 $S$와 원소 $x \notin S$에 대해서 $r(S) \leq r(S \cup \{x\}) \leq r(S)+1$이다.)
1. 매트로이드의 랭크 함수는 submodular이다. 두 집합 $A$와 $B$가 있고, $B$에 있지만 $A$에 없는 모든 원소를 $B$에서 $A$로 옮기는 것은 두 집합의 랭크의 합을 증가시키지 않는다. $r(A) + r(B) \geq r(A \cup B) + r(A \cap B)$이다.

![](https://codeforces.com/predownloaded/e2/32/e232071f8639629598a69d5d6210d2f9960c3ce0.png)

**Independence oracle.** 부분 집합의 분류를 각 부분 집합의 정보를 저장하는 것으로 다룰 수는 없다 (메모리 사용량이 지수적으로 증가한다). 부분 집합의 독립/종속을 확인하기 위한 다른 도구가 필요하다. 만약 매트로이드가 어떤 다른 구조 원소간의 관계의 결과로서 정의된다면, 다항 시간에 동작하는 부분 집합의 독립성을 판단하는 알고리즘을 대부분의 경우 찾을 수 있다. 매트로이드의 개념을 추상화하고 내부적인 독립성 매커니즘에 관계없이 사용하고 싶으므로, 부분 집합의 독립성을 검사하기 위한 서브루틴으로 *independence oracle*을 정의한다. 그리고 어떤 알고리즘의 수행 시간을 *oracle call*의 횟수로 구할 수 있다. (그러나 실제로는 알고리즘 최적화 때문에 내부 매커니즘을 완전히 잊을 수는 없다.)
